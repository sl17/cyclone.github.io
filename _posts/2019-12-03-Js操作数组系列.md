---
published: true
layout: post
date: '2019-12-03 13:32:20 +0300'
tags:
  - JavaScript
---
## Js操作数组系列

### 数组补位
>数组共有24小时项，返回的数组可能时间会中断，需要把前面的空位补上

before：`arr = [{id:18,txt: 18},{id:19,txt: 19},{id:21,txt: 21},{id:22,txt: 22}]`

after: `arr = [18, 18, 18, 18, 18, 18, 18, 18, 18, 18, 18, 18, 18, 18, 18, 18, 18, 18, 18, 19, 19, 21, 22, 22]`

```
var commentList = [...Array(24)].map(_=>0);
//判断如果0点没有值，把数组第一项赋值
if(arr[0].id > 0){
  arr.unshift(arr[0])
  arr[0].id = 0
}
for (const key in arr) {
  for (var i = 0; i < 24; i++) {
    if(arr[key].id < i){
      commentList.splice(i,1,arr[key].txt);
    }else{
      commentList.splice(arr[key].id,1,arr[key].txt);
    }
  }
}
```

### 对象变数组

before：`var category = {"美食":1,"交通汽车":1,"美女":1,"财经投资":1,"音乐":1}`

after：`[{name: "音乐", value: 1},{name: "财经投资", value: 1},{name: "美女", value: 1},{name: "交通汽车", value: 1},{name: "美食", value: 1}]`

```
var category = {"美食":1,"交通汽车":1,"美女":1,"财经投资":1,"音乐":1}
let dataChart = [];
Object.keys(category).forEach(key => {
  let v = {
    name: key,
    value: category[key]
  };
  dataChart.unshift(v);
});
console.log(dataChart)
```

### 数组相同项合并

before: `let list = [ { amount: 1, name: "家庭" }, { amount: 1, name: "是的" }, { amount: 1, name: "家庭" }, { amount: 1, name: "家庭" }, { amount: 1, name: "家庭" }, { amount: 1, name: "圣" }, { amount: 1, name: "圣诞节" }, { amount: 1, name: "圣诞节" }, { amount: 1, name: "节" }, { amount: 1, name: "诞" }, { amount: 1, name: "是的" }, { amount: 1, name: "撒旦" }, { amount: 1, name: "圣诞节" }, { amount: 1, name: "圣诞节" }, { amount: 1, name: "撒旦" }, { amount: 1, name: "旦" }, ]`

after:	`[{a: 4, i: "家庭"},{a: 2, i: "是的"},{a: 1, i: "圣"},{a: 4, i: "圣诞节"},{a: 1, i: "节"},{a: 1, i: "诞"},{a: 2, i: "撒旦"},{a: 1, i: "旦"}]`

```
let s = new Set()
list.map(i => {
  s.add(i.name)
})
let ss = []
Array.from(s).map(i => {
  let a = 0
  list.map(j => {
    if (i === j.name) {
      console.log(i, j.amount)
      a += j.amount
    }
  })
  ss.push({a,i})
})
console.log(ss)

```

